<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHHOTU PREMIER LEAGUE | BROADCAST SUITE</title>
    
    <!-- HIGH END FONTS IMPORT -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,400;0,700;0,900;1,700&family=Orbitron:wght@400;700;900&family=Teko:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* =================================================================================
           1. CORE DESIGN SYSTEM & VARIABLES
           ================================================================================= */
        :root {
            /* Theme Colors */
            --primary-dark: #050b14;
            --primary-panel: #0f172a;
            --gold-accent: #fbbf24;
            --gold-glow: rgba(251, 191, 36, 0.5);
            --neon-blue: #06b6d4;
            --neon-glow: rgba(6, 182, 212, 0.5);
            --danger-red: #ef4444;
            --pure-white: #ffffff;
            --glass-white: rgba(255, 255, 255, 0.1);
            
            /* Typography */
            --font-head: 'Orbitron', sans-serif;  /* For Titles/Numbers */
            --font-body: 'Exo 2', sans-serif;     /* For Names */
            --font-condensed: 'Teko', sans-serif; /* For Stats */
            
            /* Dimensions */
            --board-height: 140px;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            outline: none;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            background-image: 
                radial-gradient(circle at 20% 30%, #1e293b 0%, #000 100%);
            color: var(--pure-white);
            font-family: var(--font-body);
            overflow-x: hidden;
        }

        /* =================================================================================
           2. ANIMATIONS & EFFECTS
           ================================================================================= */
        @keyframes shine-pass {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        @keyframes pulse-live {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        @keyframes float-entry {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Shine Effect Class */
        .live-shine {
            position: relative;
            overflow: hidden;
        }
        .live-shine::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(
                120deg,
                rgba(255,255,255,0) 30%,
                rgba(255,255,255,0.15) 50%,
                rgba(255,255,255,0) 70%
            );
            background-size: 200% 100%;
            animation: shine-pass 3s infinite linear;
            pointer-events: none;
        }

        /* =================================================================================
           3. MAIN SCOREBOARD (FIXED TOP)
           ================================================================================= */
        .scoreboard-container {
            position: sticky;
            top: 20px;
            width: 96%;
            max-width: 1400px;
            margin: 0 auto;
            height: var(--board-height);
            display: grid;
            grid-template-columns: 3fr 4fr 3fr;
            background: var(--primary-panel);
            border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8), 0 0 0 2px rgba(255,255,255,0.05);
            z-index: 1000;
            border-bottom: 4px solid var(--gold-accent);
        }

        /* --- LEFT: BATSMEN --- */
        .segment-left {
            background: linear-gradient(90deg, #0f172a 0%, #1e293b 100%);
            border-radius: 12px 0 0 12px;
            padding: 15px 25px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-right: 1px solid var(--glass-white);
            position: relative;
        }

        .bat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 0;
            transition: all 0.3s ease;
        }
        
        .bat-row.active {
            background: linear-gradient(90deg, rgba(251, 191, 36, 0.1), transparent);
            border-left: 4px solid var(--gold-accent);
            padding-left: 10px;
        }
        
        .bat-row.active .b-name { color: var(--gold-accent); text-shadow: 0 0 10px var(--gold-glow); }
        .bat-icon { opacity: 0; margin-right: 8px; color: var(--gold-accent); }
        .bat-row.active .bat-icon { opacity: 1; }

        .b-name { font-size: 1.4rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; }
        .b-score { font-family: var(--font-head); font-size: 1.6rem; color: var(--pure-white); }

        /* --- CENTER: MAIN SCORE & HEADER --- */
        .segment-center {
            display: flex;
            flex-direction: column;
            position: relative;
            background: #0b1120;
        }

        .tour-header {
            background: linear-gradient(180deg, #1e3c72 0%, #000 100%);
            text-align: center;
            padding: 8px 0;
            font-family: var(--font-head);
            font-weight: 900;
            font-size: 1.2rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--pure-white);
            border-bottom: 1px solid var(--glass-white);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
            position: relative;
        }
        .tour-header::before {
            content: '● LIVE';
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.7rem;
            background: var(--danger-red);
            padding: 2px 8px;
            border-radius: 4px;
            animation: pulse-live 1.5s infinite;
        }

        .main-score-area {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            position: relative;
        }

        .team-flag { font-size: 2rem; font-weight: 900; color: rgba(255,255,255,0.3); }
        
        .big-score {
            font-family: var(--font-head);
            font-size: 4.5rem;
            font-weight: 900;
            line-height: 1;
            background: linear-gradient(to bottom, #fff, #aaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 4px 0px rgba(0,0,0,0.5));
        }
        
        .big-overs {
            font-family: var(--font-head);
            font-size: 1.8rem;
            color: var(--gold-accent);
            margin-top: 15px;
        }

        .equation-bar {
            background: rgba(255,255,255,0.05);
            text-align: center;
            padding: 6px;
            font-family: var(--font-condensed);
            font-size: 1.3rem;
            letter-spacing: 1px;
            color: var(--neon-blue);
            border-top: 1px solid var(--glass-white);
        }

        /* --- RIGHT: BOWLER & BALLS --- */
        .segment-right {
            background: linear-gradient(270deg, #0f172a 0%, #1e293b 100%);
            border-radius: 0 12px 12px 0;
            padding: 15px 25px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-left: 1px solid var(--glass-white);
            align-items: flex-end; /* Right align content */
        }

        .bowler-wrapper {
            text-align: right;
            margin-bottom: 10px;
            width: 100%;
        }
        .bw-label { font-size: 0.8rem; color: #888; letter-spacing: 1px; text-transform: uppercase; }
        .bw-name { font-size: 1.6rem; font-weight: 700; text-transform: uppercase; color: var(--pure-white); }
        .bw-figs { font-family: var(--font-head); font-size: 1.4rem; color: var(--gold-accent); }

        .over-timeline {
            display: flex;
            gap: 8px;
            margin-top: 5px;
        }
        
        .ball-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #222;
            border: 2px solid #444;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font-head);
            font-size: 0.9rem;
            font-weight: bold;
            color: #fff;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
            transition: transform 0.2s;
        }
        
        /* Ball Colors */
        .b-dot { background: #333; color: #aaa; }
        .b-1, .b-2, .b-3 { background: #3b82f6; border-color: #60a5fa; }
        .b-4 { background: var(--gold-accent); color: #000; border-color: #fff; box-shadow: 0 0 10px var(--gold-glow); transform: scale(1.1); }
        .b-6 { background: var(--danger-red); border-color: #fff; box-shadow: 0 0 10px rgba(239, 68, 68, 0.5); transform: scale(1.1); }
        .b-w { background: #fff; color: #000; border-color: var(--danger-red); }
        .b-wd, .b-nb { background: #8b5cf6; border-color: #a78bfa; }

        /* =================================================================================
           4. AUTH SCREEN (CENTERED)
           ================================================================================= */
        .auth-container {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: #111;
            padding: 40px;
            border-radius: 20px;
            border: 1px solid #333;
            text-align: center;
            z-index: 2000;
            box-shadow: 0 20px 50px rgba(0,0,0,0.9);
            width: 400px;
        }
        
        .auth-container h2 { margin-top: 0; color: var(--gold-accent); font-family: var(--font-head); }
        .auth-input {
            width: 100%;
            padding: 15px;
            margin: 20px 0;
            background: #222;
            border: 1px solid #444;
            color: #fff;
            text-align: center;
            font-size: 1.2rem;
            border-radius: 8px;
            font-family: var(--font-head);
            letter-spacing: 5px;
        }
        .btn-login {
            background: var(--neon-blue);
            color: #000;
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-weight: 900;
            cursor: pointer;
            font-family: var(--font-head);
            text-transform: uppercase;
        }

        /* =================================================================================
           5. ADMIN PANEL (BELOW SCOREBOARD)
           ================================================================================= */
        .admin-dashboard {
            max-width: 1400px;
            margin: 30px auto;
            display: none; /* Hidden by default */
            grid-template-columns: 1fr 2fr 1fr;
            gap: 20px;
            padding-bottom: 50px;
            animation: float-entry 0.5s ease-out;
        }

        .panel-box {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 20px;
        }

        .panel-head {
            font-family: var(--font-head);
            color: var(--neon-blue);
            border-bottom: 2px solid var(--neon-blue);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.1rem;
            display: flex;
            justify-content: space-between;
        }

        .ctrl-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        .btn-ctrl {
            padding: 20px 0;
            font-family: var(--font-head);
            font-size: 1.4rem;
            font-weight: 700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.1s;
            background: #1e293b;
            color: #fff;
            box-shadow: 0 4px 0 rgba(0,0,0,0.3);
        }
        .btn-ctrl:active { transform: translateY(4px); box-shadow: none; }
        
        .c-1 { background: #3b82f6; }
        .c-4 { background: var(--gold-accent); color: #000; }
        .c-6 { background: var(--danger-red); }
        .c-w { background: #fff; color: #000; grid-column: span 2; }
        .c-undo { background: #475569; color: #94a3b8; font-size: 1rem; }
        
        .input-row { margin-bottom: 15px; }
        .input-row label { display: block; font-size: 0.8rem; color: #888; margin-bottom: 5px; text-transform: uppercase; }
        .dark-input {
            width: 100%;
            background: #020617;
            border: 1px solid #1e293b;
            padding: 10px;
            color: #fff;
            border-radius: 6px;
            font-family: var(--font-body);
        }

        /* Responsive Fixes */
        @media (max-width: 1100px) {
            .scoreboard-container { height: auto; grid-template-columns: 1fr; }
            .segment-left, .segment-right { border: none; border-bottom: 1px solid #333; }
            .admin-dashboard { grid-template-columns: 1fr; }
        }

    </style>
</head>
<body>

    <!-- ================= AUTH SCREEN ================= -->
    <div id="loginOverlay" class="auth-container">
        <h2><i class="fas fa-lock"></i> SECURITY CHECK</h2>
        <p style="color:#666; font-size:0.9rem;">ENTER BROADCAST KEY TO ACCESS CONSOLE</p>
        <input type="password" id="passInput" class="auth-input" placeholder="••••••••">
        <button class="btn-login" onclick="verifyAdmin()">UNLOCK SYSTEM</button>
        <p style="color:red; font-size:0.8rem; margin-top:10px; display:none;" id="errMsg">ACCESS DENIED</p>
    </div>

    <!-- ================= MAIN SCOREBOARD ================= -->
    <div class="scoreboard-container live-shine" id="mainBoard">
        
        <!-- SECTION 1: BATSMEN -->
        <div class="segment-left">
            <div class="bat-row active" id="row-p1">
                <div>
                    <i class="fas fa-cricket-bat-ball bat-icon"></i>
                    <span class="b-name" id="disp-p1-name">KHOLI</span>
                </div>
                <span class="b-score" id="disp-p1-score">45(28)</span>
            </div>
            
            <div class="bat-row" id="row-p2">
                <div>
                    <i class="fas fa-cricket-bat-ball bat-icon"></i>
                    <span class="b-name" id="disp-p2-name">ROHIT</span>
                </div>
                <span class="b-score" id="disp-p2-score">12(08)</span>
            </div>
        </div>

        <!-- SECTION 2: HEADER & SCORE -->
        <div class="segment-center">
            <div class="tour-header" id="disp-tour">CHHOTU PREMIER LEAGUE</div>
            
            <div class="main-score-area">
                <div class="team-flag" id="disp-team">IND</div>
                <div class="big-score"><span id="score-runs">142</span>/<span id="score-wkts">2</span></div>
                <div class="big-overs" id="score-overs">14.2</div>
            </div>

            <div class="equation-bar" id="disp-equation">
                TARGET: 245 | NEED 103 RUNS IN 34 BALLS
            </div>
        </div>

        <!-- SECTION 3: BOWLER -->
        <div class="segment-right">
            <div class="bowler-wrapper">
                <div class="bw-label">CURRENT BOWLER</div>
                <div class="bw-name" id="disp-bowler">M. STARC</div>
                <div class="bw-figs" id="disp-bowl-figs">1/24 (2.2)</div>
            </div>
            
            <!-- 6 BALL INDICATORS -->
            <div class="over-timeline" id="ball-timeline">
                <!-- Javascript will inject these -->
                <div class="ball-circle b-dot">1</div>
                <div class="ball-circle b-4">4</div>
                <div class="ball-circle b-dot">2</div>
                <div class="ball-circle b-dot">3</div>
                <div class="ball-circle b-dot">4</div>
                <div class="ball-circle b-dot">5</div>
            </div>
        </div>
    </div>

    <!-- ================= ADMIN DASHBOARD ================= -->
    <div class="admin-dashboard" id="adminPanel">
        
        <!-- PANEL 1: MATCH SETUP -->
        <div class="panel-box">
            <div class="panel-head"><span>MATCH CONFIG</span> <i class="fas fa-cog"></i></div>
            
            <div class="input-row">
                <label>Tournament Name</label>
                <input type="text" class="dark-input" id="in-tour" value="CHHOTU PREMIER LEAGUE" oninput="syncManual()">
            </div>
            <div class="input-row">
                <label>Batting Team</label>
                <input type="text" class="dark-input" id="in-team" value="IND" oninput="syncManual()">
            </div>
            <div class="input-row">
                <label>Target</label>
                <input type="number" class="dark-input" id="in-target" value="245" oninput="syncManual()">
            </div>
            <div style="margin-top:20px; padding:10px; background:rgba(255,255,255,0.05); border-radius:8px;">
                <div style="font-size:0.8rem; color:#888;">AUTO STATS</div>
                <div style="display:flex; justify-content:space-between; margin-top:5px;">
                    <span>CRR: <span id="stat-crr" style="color:var(--neon-blue)">8.50</span></span>
                    <span>RRR: <span id="stat-rrr" style="color:var(--danger-red)">9.10</span></span>
                </div>
            </div>
        </div>

        <!-- PANEL 2: SCORING PAD -->
        <div class="panel-box">
            <div class="panel-head"><span>SCORING ENGINE</span> <i class="fas fa-gamepad"></i></div>
            
            <div class="ctrl-grid">
                <button class="btn-ctrl" onclick="addRuns(0)">0</button>
                <button class="btn-ctrl c-1" onclick="addRuns(1)">1</button>
                <button class="btn-ctrl c-1" onclick="addRuns(2)">2</button>
                <button class="btn-ctrl c-1" onclick="addRuns(3)">3</button>
                
                <button class="btn-ctrl c-4" onclick="addRuns(4)">4</button>
                <button class="btn-ctrl c-6" onclick="addRuns(6)">6</button>
                <button class="btn-ctrl c-w" onclick="addWicket()">WICKET</button>
                
                <button class="btn-ctrl c-undo" onclick="processExtra('WD')">WD</button>
                <button class="btn-ctrl c-undo" onclick="processExtra('NB')">NB</button>
                <button class="btn-ctrl c-undo" onclick="undoAction()">UNDO</button>
                <button class="btn-ctrl" style="background:var(--neon-blue); color:#000; font-size:1rem;" onclick="swapStrike()">SWAP</button>
            </div>
        </div>

        <!-- PANEL 3: PLAYER DATA -->
        <div class="panel-box">
            <div class="panel-head"><span>PLAYERS</span> <i class="fas fa-users"></i></div>
            
            <div class="input-row" style="border-left:3px solid var(--gold-accent); padding-left:10px;">
                <label>Striker</label>
                <input type="text" class="dark-input" id="in-p1" oninput="syncManual()">
                <div style="display:flex; gap:5px; margin-top:5px;">
                    <input type="number" class="dark-input" id="in-p1-r" placeholder="R" oninput="syncManual()">
                    <input type="number" class="dark-input" id="in-p1-b" placeholder="B" oninput="syncManual()">
                </div>
            </div>

            <div class="input-row" style="padding-left:10px;">
                <label>Non-Striker</label>
                <input type="text" class="dark-input" id="in-p2" oninput="syncManual()">
                <div style="display:flex; gap:5px; margin-top:5px;">
                    <input type="number" class="dark-input" id="in-p2-r" placeholder="R" oninput="syncManual()">
                    <input type="number" class="dark-input" id="in-p2-b" placeholder="B" oninput="syncManual()">
                </div>
            </div>

            <div class="input-row" style="border-top:1px solid #333; margin-top:15px; padding-top:10px;">
                <label>Bowler</label>
                <input type="text" class="dark-input" id="in-bw" oninput="syncManual()">
                <div style="display:flex; gap:5px; margin-top:5px;">
                    <input type="number" class="dark-input" id="in-bw-w" placeholder="W" oninput="syncManual()">
                    <input type="number" class="dark-input" id="in-bw-r" placeholder="R" oninput="syncManual()">
                </div>
            </div>
        </div>

    </div>

    <script>
        /* =================================================================================
           JAVASCRIPT LOGIC ENGINE
           ================================================================================= */
        
        // --- 1. STATE MANAGEMENT ---
        let matchState = {
            meta: { tour: "CHHOTU PREMIER LEAGUE", team: "IND" },
            score: { runs: 142, wkts: 2, overs: 14, balls: 2, target: 245 },
            batting: {
                p1: { name: "KOHLI", runs: 45, balls: 28 },
                p2: { name: "ROHIT", runs: 12, balls: 8 },
                strike: 1 // 1 or 2
            },
            bowling: {
                name: "M. STARC", runs: 24, wkts: 1, overs: 2, balls: 2
            },
            thisOver: [1, 4], // Array to track balls 1,4,0,W etc.
            history: [] // For Undo functionality
        };

        // --- 2. AUTHENTICATION ---
        function verifyAdmin() {
            const pass = document.getElementById('passInput').value;
            if(pass === "Chhotu@8718") {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'grid';
                initSystem();
            } else {
                const err = document.getElementById('errMsg');
                err.style.display = 'block';
                err.classList.add('animate__animated', 'animate__shakeX');
            }
        }

        // --- 3. INITIALIZATION ---
        function initSystem() {
            // Load from LocalStorage if exists
            const saved = localStorage.getItem('cpl_state_v2');
            if(saved) matchState = JSON.parse(saved);
            updateDashboardInputs();
            renderBoard();
        }

        // --- 4. SCORING FUNCTIONS ---
        function saveState() {
            // Push deep copy to history
            if(matchState.history.length > 20) matchState.history.shift();
            matchState.history.push(JSON.parse(JSON.stringify(matchState)));
            localStorage.setItem('cpl_state_v2', JSON.stringify(matchState));
        }

        function addRuns(runs) {
            saveState();
            
            // Match Score
            matchState.score.runs += runs;
            
            // Batting Stats
            if(matchState.batting.strike === 1) {
                matchState.batting.p1.runs += runs;
                matchState.batting.p1.balls++;
            } else {
                matchState.batting.p2.runs += runs;
                matchState.batting.p2.balls++;
            }

            // Bowling Stats
            matchState.bowling.runs += runs;
            
            // Ball Count Logic
            handleLegalBall(runs);
        }

        function addWicket() {
            saveState();
            matchState.score.wkts++;
            matchState.bowling.wkts++;
            
            // Mark batsman out (Simplified: Current striker gets out)
            if(matchState.batting.strike === 1) {
                matchState.batting.p1.balls++;
                matchState.batting.p1.name = "NEW BATSMAN";
                matchState.batting.p1.runs = 0;
                matchState.batting.p1.balls = 0;
            } else {
                matchState.batting.p2.balls++;
                matchState.batting.p2.name = "NEW BATSMAN";
                matchState.batting.p2.runs = 0;
                matchState.batting.p2.balls = 0;
            }

            handleLegalBall('W');
        }

        function processExtra(type) {
            saveState();
            matchState.score.runs++; // 1 run for extra
            matchState.bowling.runs++;
            // Note: Wide/NoBall doesn't increment ball count in standard logic here
            // but we add it to the timeline visual
            // matchState.thisOver.push(type); // Optional: add to visual
            renderBoard();
        }

        function handleLegalBall(val) {
            matchState.score.balls++;
            matchState.bowling.balls++;
            matchState.thisOver.push(val);

            // Strike Rotation
            if(typeof val === 'number' && val % 2 !== 0) {
                swapStrikeLogic();
            }

            // Over Completion
            if(matchState.score.balls >= 6) {
                matchState.score.overs++;
                matchState.score.balls = 0;
                
                matchState.bowling.overs++;
                matchState.bowling.balls = 0;
                
                matchState.thisOver = []; // Reset visual balls
                swapStrikeLogic(); // End of over swap
            } else if (matchState.bowling.balls >= 6) {
                 // Logic incase bowling stats unsynced
                 matchState.bowling.overs++;
                 matchState.bowling.balls = 0;
            }
            
            renderBoard();
            updateDashboardInputs();
        }

        function swapStrike() {
            saveState();
            swapStrikeLogic();
            renderBoard();
        }

        function swapStrikeLogic() {
            matchState.batting.strike = matchState.batting.strike === 1 ? 2 : 1;
        }

        function undoAction() {
            if(matchState.history.length > 0) {
                matchState = matchState.history.pop();
                renderBoard();
                updateDashboardInputs();
                localStorage.setItem('cpl_state_v2', JSON.stringify(matchState));
            }
        }

        // --- 5. RENDER ENGINE (UI UPDATE) ---
        function renderBoard() {
            // Text Updates
            document.getElementById('disp-tour').innerText = matchState.meta.tour;
            document.getElementById('disp-team').innerText = matchState.meta.team;
            
            document.getElementById('score-runs').innerText = matchState.score.runs;
            document.getElementById('score-wkts').innerText = matchState.score.wkts;
            document.getElementById('score-overs').innerText = `${matchState.score.overs}.${matchState.score.balls}`;

            // Batsmen
            document.getElementById('disp-p1-name').innerText = matchState.batting.p1.name;
            document.getElementById('disp-p1-score').innerText = `${matchState.batting.p1.runs}(${matchState.batting.p1.balls})`;
            document.getElementById('disp-p2-name').innerText = matchState.batting.p2.name;
            document.getElementById('disp-p2-score').innerText = `${matchState.batting.p2.runs}(${matchState.batting.p2.balls})`;

            // Active Striker Highlight
            const r1 = document.getElementById('row-p1');
            const r2 = document.getElementById('row-p2');
            if(matchState.batting.strike === 1) {
                r1.classList.add('active'); r2.classList.remove('active');
            } else {
                r2.classList.add('active'); r1.classList.remove('active');
            }

            // Bowler
            document.getElementById('disp-bowler').innerText = matchState.bowling.name;
            document.getElementById('disp-bowl-figs').innerText = `${matchState.bowling.wkts}/${matchState.bowling.runs} (${matchState.bowling.overs}.${matchState.bowling.balls})`;

            // Equation & Stats Calc
            const totalBalls = (matchState.score.overs * 6) + matchState.score.balls;
            const crr = totalBalls === 0 ? 0 : (matchState.score.runs / totalBalls) * 6;
            document.getElementById('stat-crr').innerText = crr.toFixed(2);

            if(matchState.score.target > 0) {
                const need = matchState.score.target - matchState.score.runs;
                const remBalls = 120 - totalBalls; // Assuming T20
                const rrr = remBalls <= 0 ? 0 : (need / remBalls) * 6;
                
                document.getElementById('stat-rrr').innerText = rrr.toFixed(2);
                document.getElementById('disp-equation').innerText = `TARGET: ${matchState.score.target} | NEED ${need} OFF ${remBalls}`;
            } else {
                 document.getElementById('disp-equation').innerText = `1ST INNINGS | CRR: ${crr.toFixed(2)}`;
            }

            // Render Ball Circles (The "6 Gole")
            const tl = document.getElementById('ball-timeline');
            tl.innerHTML = ''; // Clear current
            
            // Fill existing balls
            matchState.thisOver.forEach(val => {
                const d = document.createElement('div');
                d.className = 'ball-circle';
                d.innerText = val;
                
                // Styling classes
                if(val === 4) d.classList.add('b-4');
                else if(val === 6) d.classList.add('b-6');
                else if(val === 'W') d.classList.add('b-w');
                else if(val === 'WD' || val === 'NB') d.classList.add('b-wd');
                else d.classList.add('b-1'); // Default blue for runs
                
                tl.appendChild(d);
            });

            // Fill remaining empty spots (1 to 6)
            for(let i = matchState.thisOver.length + 1; i <= 6; i++) {
                const d = document.createElement('div');
                d.className = 'ball-circle b-dot';
                d.innerText = i; // Number 1,2,3... inside
                tl.appendChild(d);
            }
        }

        // --- 6. SYNC INPUTS (Manual Edit) ---
        function updateDashboardInputs() {
            document.getElementById('in-tour').value = matchState.meta.tour;
            document.getElementById('in-team').value = matchState.meta.team;
            document.getElementById('in-target').value = matchState.score.target;
            
            document.getElementById('in-p1').value = matchState.batting.p1.name;
            document.getElementById('in-p1-r').value = matchState.batting.p1.runs;
            document.getElementById('in-p1-b').value = matchState.batting.p1.balls;
            
            document.getElementById('in-p2').value = matchState.batting.p2.name;
            document.getElementById('in-p2-r').value = matchState.batting.p2.runs;
            document.getElementById('in-p2-b').value = matchState.batting.p2.balls;

            document.getElementById('in-bw').value = matchState.bowling.name;
            document.getElementById('in-bw-r').value = matchState.bowling.runs;
            document.getElementById('in-bw-w').value = matchState.bowling.wkts;
        }

        function syncManual() {
            matchState.meta.tour = document.getElementById('in-tour').value;
            matchState.meta.team = document.getElementById('in-team').value;
            matchState.score.target = parseInt(document.getElementById('in-target').value) || 0;
            
            matchState.batting.p1.name = document.getElementById('in-p1').value;
            matchState.batting.p1.runs = parseInt(document.getElementById('in-p1-r').value) || 0;
            matchState.batting.p1.balls = parseInt(document.getElementById('in-p1-b').value) || 0;
            
            matchState.batting.p2.name = document.getElementById('in-p2').value;
            matchState.batting.p2.runs = parseInt(document.getElementById('in-p2-r').value) || 0;
            matchState.batting.p2.balls = parseInt(document.getElementById('in-p2-b').value) || 0;
            
            matchState.bowling.name = document.getElementById('in-bw').value;
            matchState.bowling.runs = parseInt(document.getElementById('in-bw-r').value) || 0;
            matchState.bowling.wkts = parseInt(document.getElementById('in-bw-w').value) || 0;

            renderBoard();
        }

    </script>
</body>
</html>
