<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chhotu Ultra-Pro Scorer 2026</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Oswald:wght@500;700&display=swap');
        
        :root { --primary: #fec309; --neon-blue: #00e1ff; --neon-red: #ff0040; --bg: #030a16; }

        body { background: var(--bg); color: white; font-family: 'Oswald', sans-serif; margin: 0; padding-bottom: 50px; }

        /* --- PREMIUM BROADCAST SCOREBOARD --- */
        .master-container { width: 100%; max-width: 1000px; margin: auto; position: sticky; top: 0; z-index: 1000; background: var(--bg); }
        
        .top-status-bar { 
            background: #000; display: flex; justify-content: space-between; align-items: center;
            padding: 5px 20px; font-size: 12px; font-family: 'Orbitron'; border-bottom: 1px solid #222;
        }

        .win-bar-container { height: 6px; background: #111; position: relative; display: flex; overflow: hidden; }
        #win-p1 { 
    background: var(--neon-blue); 
    height: 100%; 
    transition: 2s ease-in-out; 
    box-shadow: 0 0 10px var(--neon-blue); 
}

#win-p2 { 
    background: var(--neon-red); 
    height: 100%; 
    transition: 2s ease-in-out; 
    box-shadow: 0 0 10px var(--neon-red); 
}
        

        .main-board { 
            height: 70px; background: linear-gradient(90deg, #00122e 0%, #002b6b 100%);
            display: flex; align-items: center; position: relative; overflow: hidden;
            border-bottom: 3px solid var(--primary);
        }

        .team-tag { 
            background: var(--primary); color: #000; font-weight: 900; font-size: 22px;
            padding: 0 25px; height: 100%; display: flex; align-items: center;
            clip-path: polygon(0 0, 85% 0, 100% 100%, 0% 100%); font-family: 'Orbitron';
        }

        .live-score { font-size: 42px; font-weight: 900; padding: 0 15px; font-family: 'Orbitron'; letter-spacing: -2px; }
        .overs-small { font-size: 16px; opacity: 0.7; color: #ccc; margin-left: 5px; }

        .batsmen-section { flex-grow: 1; padding: 0 20px; border-left: 1px solid rgba(255,255,255,0.1); }
        .b-row { font-size: 18px; display: flex; justify-content: space-between; margin: 2px 0; }
        .active-bat { color: var(--primary); text-shadow: 0 0 10px rgba(254,195,9,0.5); }

        .opp-box { background: rgba(255,255,255,0.05); height: 100%; padding: 0 15px; display: flex; flex-direction: column; justify-content: center; text-align: center; min-width: 120px; border-left: 1px solid #333; }
        .target-label { font-size: 10px; color: var(--primary); letter-spacing: 1px; }

        .bottom-strip { 
            background: #000; padding: 5px 15px; display: flex; justify-content: space-between; 
            align-items: center; font-size: 13px; font-weight: 700;
        }

        /* --- BALL TRACKER --- */
        .ball-tracker { display: flex; gap: 5px; }
        .b-dot { width: 22px; height: 22px; background: #222; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; border: 1px solid #444; }
        .b-dot.active { background: var(--primary); color: #000; border-color: #fff; box-shadow: 0 0 8px var(--primary); }

        /* --- ADMIN PANEL --- */
        .admin-section { padding: 20px; max-width: 900px; margin: auto; }
        .login-card { text-align: center; background: #111; padding: 40px; border-radius: 15px; border: 1px solid #333; margin-top: 20px; }
        
        .control-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; }
        .card { background: #0a1221; padding: 20px; border-radius: 12px; border: 1px solid #1a2a44; }
        
        .btn-group { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 15px; }
        button { padding: 12px; font-weight: 900; border: none; border-radius: 6px; cursor: pointer; transition: 0.2s; font-family: 'Oswald'; }
        button:active { transform: scale(0.95); }
        
        .btn-run { background: #1a73e8; color: white; }
        .btn-action { background: var(--primary); color: #000; }
        .btn-danger { background: var(--neon-red); color: white; }
        .btn-dark { background: #333; color: #fff; }

        input { width: 93%; padding: 12px; margin-bottom: 10px; background: #000; border: 1px solid #333; color: white; border-radius: 6px; font-size: 14px; }
        label { font-size: 12px; color: var(--primary); display: block; margin-bottom: 5px; text-transform: uppercase; }

        #boundary-msg { 
            position: fixed; top: 30%; left: 0; width: 100%; background: var(--primary); color: #000;
            font-size: 70px; font-weight: 900; text-align: center; padding: 20px 0; display: none; z-index: 2000;
            font-family: 'Orbitron'; animation: zoomIn 0.4s;
        }
        @keyframes zoomIn { from { transform: scale(0); } to { transform: scale(1); } }

        .hidden { display: none !important; }
    </style>
</head>
<body onload="initApp()">

    <div id="boundary-msg">FOUR!</div>

    <div class="master-container">
        <div class="top-status-bar">
            <div id="proj-container" style="text-align:center; margin-top:-10px; margin-bottom:5px;">
    <span id="d-proj" style="background:white; color:black; padding:2px 15px; border-radius:20px; font-weight:900; font-size:12px; box-shadow:0 0 10px #fff;">PROJECTED SCORE: 0</span>
</div>

            <span id="d-tour">TOURNAMENT NAME</span>
            <span id="d-clock">00:00:00</span>
        </div>
        <div class="win-bar-container">
            <div id="win-p1" style="width: 50%;"></div>
            <div id="win-p2" style="width: 50%;"></div>
        </div>
        <div class="main-board">
            <div class="team-tag" id="d-team">TEAM A</div>
            <div class="live-score">
                <span id="d-runs">0</span>-<span id="d-wkt">0</span>
                <span class="overs-small">(<span id="d-ov">0.0</span>)</span>
            </div>
            <div class="batsmen-section">
                <div id="p1-row" class="b-row active-bat">
                    <span id="d-b1">BATSMAN 1</span> <span id="d-b1-r">0(0)</span>
                </div>
                <div id="p2-row" class="b-row">
                    <span id="d-b2">BATSMAN 2</span> <span id="d-b2-r">0(0)</span>
                </div>
            </div>
            <div class="opp-box">
                <span id="d-opp-name" style="font-size: 12px; opacity: 0.6;">OPPONENT</span>
                <span id="d-opp-score" style="font-size: 18px; font-weight: 900;">0-0 (0.0)</span>
                <span class="target-label">TARGET: <span id="d-target">0</span></span>
            </div>
        </div>
        <div class="bottom-strip">
            <span id="d-equation">1ST INNINGS IN PROGRESS</span>
            <div style="display: flex; align-items: center; gap: 15px;">
                <span>BOWLER: <span id="d-bowl" style="color:var(--primary)">WAITING</span></span>
                <div class="ball-tracker" id="d-dots">
                    <div class="b-dot">1</div><div class="b-dot">2</div><div class="b-dot">3</div><div class="b-dot">4</div><div class="b-dot">5</div><div class="b-dot">6</div>
                </div>
            </div>
        </div>
    </div>

    <div class="admin-section">
        <div id="login-area" class="login-card">
            <h1 style="color:var(--primary); font-family: 'Orbitron';">üõ°Ô∏è ADMIN ACCESS</h1>
            <input type="password" id="pass-input" placeholder="ENTER SECURE PIN" style="text-align:center; font-size: 24px;">
            <button class="btn-action" onclick="checkAuth()" style="width:100%; padding:20px;">UNLOCK CONTROLS</button>
        </div>

        <div id="admin-panel" class="hidden">
            <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="color:var(--primary)">CONTROL DASHBOARD</h2>
                <button class="btn-danger" onclick="lockPanel()">üîí LOCK & EXIT</button>
            </div>

            <div class="control-grid">
                <div class="card">
                    <label>Quick Scoring</label>
                    <div class="btn-group">
                        <button class="btn-run" onclick="addRun(1)">+1</button>
                        <button class="btn-run" onclick="addRun(2)">+2</button>
                        <button class="btn-run" onclick="addRun(3)">+3</button>
                        <button class="btn-danger" onclick="addRun(-1)">-1</button>
                    </div>
                    <div class="btn-group">
                        <button class="btn-action" onclick="showAnim('FOUR', 4)">4</button>
                        <button class="btn-action" onclick="showAnim('SIX', 6)">6</button>
                        <button class="btn-danger" onclick="outPlayer()" style="grid-column: span 2;">WICKET</button>
                    </div>
                    <button class="btn-run" onclick="nextBall()" style="width:100%; background:#00c853;">NEXT BALL (DOT)</button>
                    <button class="btn-dark" onclick="swapStrike()" style="width:100%; margin-top:10px;">üîÑ SWAP STRIKER</button>
                </div>

                <div class="card">
                    <label>Match Setup</label>
                    <input type="text" id="i-tour" placeholder="Tournament Name" oninput="pushData()">
                    <input type="text" id="i-t1" placeholder="Batting Team Name" oninput="pushData()">
                    <input type="text" id="i-b1" placeholder="Striker Name" oninput="pushData()">
                    <input type="text" id="i-b2" placeholder="Non-Striker Name" oninput="pushData()">
                    <input type="text" id="i-bowl" placeholder="Current Bowler" oninput="pushData()">
                    <div style="display:flex; gap:10px;">
                        <input type="number" id="i-target" placeholder="Target" oninput="pushData()">
                        <button class="btn-action" onclick="toggleInn()">INN 1/2</button>
                    </div>
                </div>

                <div class="card">
                    <label>Team Squad (11 Players)</label>
                    <div id="squad-inputs">
                        <input type="text" class="sq-name" placeholder="Player 1" oninput="updateSquad()">
                        <input type="text" class="sq-name" placeholder="Player 2" oninput="updateSquad()">
                        <button onclick="toggleSquad()" class="btn-dark" style="width:100%;">Show More Players...</button>
                        <div id="extra-squad" class="hidden">
                             </div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top:20px; background: #200;">
                <button class="btn-danger" onclick="archiveMatch()" style="width:100%; margin-bottom:10px;">üíæ END MATCH & SAVE TO HISTORY</button>
                <button class="btn-danger" onclick="fullReset()" style="width:100%; opacity:0.5;">‚ö†Ô∏è FULL RESET (CLEAN ALL)</button>
            </div>
            
            <div id="history-section" class="card" style="margin-top:20px;">
                <label>Match History Archives</label>
                <div id="year-tabs" style="display:flex; gap:10px; margin-bottom:10px;"></div>
                <div id="history-content"></div>
            </div>
        </div>
    </div>

    <script>
        // Firebase Config
        const firebaseConfig = { databaseURL: "Https://myscoreboard-b140f-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref("broadcast_master_v3");
        const archRef = firebase.database().ref("match_history");

        let state = {
            r:0, w:0, o:0, b:0, t1:"TEAM A", tour:"TOURNAMENT", 
            oppN:"OPPONENT", oppS:"0-0 (0.0)", target:0, s:1, bowl:"WAITING",
            p1:{n:"BATSMAN 1", r:0, b:0}, p2:{n:"BATSMAN 2", r:0, b:0},
            inn:1, anim:"", squad: Array(11).fill("")
        };

        function initApp() {
            // Clock
            setInterval(() => {
                const now = new Date();
                document.getElementById('d-clock').innerText = now.toLocaleTimeString();
            }, 1000);

            // Populate extra squad inputs
            const extra = document.getElementById('extra-squad');
            for(let i=3; i<=11; i++) {
                extra.innerHTML += `<input type="text" class="sq-name" placeholder="Player ${i}" oninput="updateSquad()">`;
            }

            // Sync with Firebase
            db.on('value', snap => {
                if(snap.val()) {
                    state = snap.val();
                    updateUI();
                }
            });
            loadHistory();
        }

        function checkAuth() {
            if(document.getElementById('pass-input').value === "ChhotuLive8718") {
                document.getElementById('admin-panel').classList.remove('hidden');
                document.getElementById('login-area').classList.add('hidden');
            } else alert("Wrong Pin!");
        }

        function lockPanel() {
            document.getElementById('admin-panel').classList.add('hidden');
            document.getElementById('login-area').classList.remove('hidden');
            document.getElementById('pass-input').value = "";
        }

        function addRun(v) {
            state.r += v;
            if(state.s === 1) { state.p1.r += v; } else { state.p2.r += v; }
            // Auto strike change for odd runs (except -1)
            if(v % 2 !== 0 && v !== -1) swapStrike();
            pushData();
        }

        function nextBall() {
            if(state.s === 1) state.p1.b++; else state.p2.b++;
            state.b++;
            if(state.b >= 6) { state.o++; state.b = 0; swapStrike(); }
            pushData();
        }

        function outPlayer() {
            let next = prompt("Next Batsman Name:");
            if(next) {
                if(state.s === 1) state.p1 = {n:next, r:0, b:0};
                else state.p2 = {n:next, r:0, b:0};
                state.w++;
                nextBall();
            }
        }

        function swapStrike() { state.s = state.s === 1 ? 2 : 1; pushData(); }

        function showAnim(txt, r) {
            state.anim = txt; pushData();
            addRun(r);
            setTimeout(() => { state.anim = ""; pushData(); }, 2500);
        }

        function toggleSquad() { document.getElementById('extra-squad').classList.toggle('hidden'); }

        function updateSquad() {
            const inputs = document.querySelectorAll('.sq-name');
            state.squad = Array.from(inputs).map(i => i.value);
            pushData();
        }

        function pushData() {
            // Update state from inputs if admin is open
            if(!document.getElementById('admin-panel').classList.contains('hidden')) {
                state.tour = document.getElementById('i-tour').value || state.tour;
                state.t1 = document.getElementById('i-t1').value || state.t1;
                state.p1.n = document.getElementById('i-b1').value || state.p1.n;
                state.p2.n = document.getElementById('i-b2').value || state.p2.n;
                state.bowl = document.getElementById('i-bowl').value || state.bowl;
                state.target = parseInt(document.getElementById('i-target').value) || 0;
            }
            db.set(state);
        }

        function updateUI() {
            document.getElementById('d-runs').innerText = state.r;
            document.getElementById('d-wkt').innerText = state.w;
            document.getElementById('d-ov').innerText = `${state.o}.${state.b}`;
            // Projected Score Calculation
let totalBallsPlayed = (state.o * 6) + state.b;
if (totalBallsPlayed > 0 && state.inn === 1) {
    let currentRR = state.r / (totalBallsPlayed / 6);
    let projectedFinal = Math.round(currentRR * 20); // 20 ‡§ì‡§µ‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è
    document.getElementById('d-proj').innerText = "PROJECTED SCORE: " + projectedFinal;
    document.getElementById('proj-container').style.display = "block";
} else if (state.inn === 2) {
    // ‡§¶‡•Ç‡§∏‡§∞‡•Ä ‡§™‡§æ‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§á‡§∏‡•á ‡§õ‡§ø‡§™‡§æ ‡§¶‡•á‡§Ç ‡§Ø‡§æ RRR ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç
    document.getElementById('proj-container').style.display = "none";
}
            
            document.getElementById('d-team').innerText = state.t1.substring(0,8).toUpperCase();
            document.getElementById('d-tour').innerText = state.tour.toUpperCase();
            document.getElementById('d-b1').innerText = state.p1.n;
            document.getElementById('d-b1-r').innerText = `${state.p1.r}(${state.p1.b})`;
            document.getElementById('d-b2').innerText = state.p2.n;
            document.getElementById('d-b2-r').innerText = `${state.p2.r}(${state.p2.b})`;
            document.getElementById('d-bowl').innerText = state.bowl.toUpperCase();
            document.getElementById('d-target').innerText = state.target;

            
const mainBoard = document.querySelector('.main-board');
if (state.anim === "FOUR" || state.anim === "SIX") {
    mainBoard.classList.add('animate-four-six');
} else {
    mainBoard.classList.remove('animate-four-six');
}

if (state.anim === "WICKET") {
    mainBoard.classList.add('animate-wicket');
} else {
    mainBoard.classList.remove('animate-wicket');
}
            

            // Striker Highlight
            document.getElementById('p1-row').className = state.s === 1 ? "b-row active-bat" : "b-row";
            document.getElementById('p2-row').className = state.s === 2 ? "b-row active-bat" : "b-row";

            // Dots
            const dots = document.querySelectorAll('.b-dot');
            dots.forEach((d, i) => d.className = i < state.b ? "b-dot active" : "b-dot");

            // Equation
            if(state.target > 0) {
                let rem = state.target - state.r;
                let balls = (20 * 6) - (state.o * 6 + state.b); // Assuming 20 over match
                document.getElementById('d-equation').innerText = rem <= 0 ? "MATCH FINISHED" : `${state.t1} NEEDS ${rem} RUNS IN ${balls} BALLS`;
            } else {
                document.getElementById('d-equation').innerText = "1ST INNINGS IN PROGRESS";
            }

            // Anim
            const animDiv = document.getElementById('boundary-msg');
            if(state.anim) {
                animDiv.innerText = state.anim + "!";
                animDiv.style.display = 'block';
            } else animDiv.style.display = 'none';
        }

        function archiveMatch() {
            if(!confirm("End Match and Save to History?")) return;
            let year = new Date().getFullYear();
            archRef.child(year).push({
                match: `${state.t1} vs ${state.oppN}`,
                score: `${state.r}-${state.w} (${state.o}.${state.b})`,
                date: new Date().toLocaleDateString(),
                details: state
            });
            fullReset();
        }

        function loadHistory() {
            archRef.on('value', snap => {
                const data = snap.val();
                const tabs = document.getElementById('year-tabs');
                const cont = document.getElementById('history-content');
                tabs.innerHTML = "";
                if(!data) return;
                Object.keys(data).forEach(year => {
                    tabs.innerHTML += `<button class="btn-dark" onclick="showYear('${year}')">${year}</button>`;
                });
            });
        }

        function showYear(y) {
    archRef.child(y).on('value', snap => {
        let html = "<div style='display:grid; gap:10px;'>";
        if(!snap.val()) {
            html += "<p style='opacity:0.5'>‡§á‡§∏ ‡§∏‡§æ‡§≤ ‡§ï‡•ã‡§à ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</p>";
        } else {
            snap.forEach(m => {
                let d = m.val();
                let mKey = m.key; // ‡§Æ‡•à‡§ö ‡§ï‡•Ä ‡§Ø‡•Ç‡§®‡§ø‡§ï ID
                html += `
                    <div style="background:#111; padding:10px; border-radius:8px; display:flex; justify-content:space-between; align-items:center; border-left:3px solid var(--primary);">
                        <div>
                            <b style="color:var(--primary)">${d.match}</b><br>
                            <small>${d.score} | ${d.date}</small>
                        </div>
                        <button onclick="deleteMatch('${y}', '${mKey}')" style="background:red; color:white; padding:5px 10px; font-size:12px; width:auto; border-radius:5px;">DELETE</button>
                    </div>`;
            });
        }
        document.getElementById('history-content').innerHTML = html + "</div>";
    });
}

// ‡§°‡§ø‡§≤‡•Ä‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§®‡§Ø‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function deleteMatch(year, key) {
    if(confirm("‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§á‡§∏ ‡§Æ‡•à‡§ö ‡§ï‡•ã ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§∏‡•á ‡§π‡§Æ‡•á‡§∂‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?")) {
        archRef.child(year).child(key).remove()
        .then(() => alert("‡§Æ‡•à‡§ö ‡§°‡§ø‡§≤‡•Ä‡§ü ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ!"))
        .catch((error) => alert("Error: " + error));
    }
}
     
        }

        function fullReset() {
            db.set({
                r:0, w:0, o:0, b:0, t1:"TEAM A", tour:"TOURNAMENT", 
                oppN:"OPPONENT", oppS:"0-0 (0.0)", target:0, s:1, bowl:"WAITING",
                p1:{n:"BATSMAN 1", r:0, b:0}, p2:{n:"BATSMAN 2", r:0, b:0},
                inn:1, anim:"", squad: Array(11).fill("")
            });
            location.reload();
        }
    </script>
</body>
</html>
