<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chhotu Ultra-Pro Scorer 2026</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Oswald:wght@500;700&display=swap');
        
        :root { --primary: #fec309; --neon-blue: #00e1ff; --neon-red: #ff0040; --bg: #030a16; --card-bg: #0a1221; }

        body { background: var(--bg); color: white; font-family: 'Oswald', sans-serif; margin: 0; padding-bottom: 50px; overflow-x: hidden; }

        /* Animations */
        @keyframes flash-yellow { 0% { background: #00122e; } 50% { background: #fec309; } 100% { background: #00122e; } }
        .animate-four-six { animation: flash-yellow 0.5s ease 3; }

        .master-container { width: 100%; max-width: 1000px; margin: auto; position: sticky; top: 0; z-index: 1000; background: var(--bg); border-bottom: 2px solid #222; }
        
        .top-status-bar { 
            background: #000; display: flex; justify-content: space-between; align-items: center;
            padding: 5px 20px; font-size: 11px; font-family: 'Orbitron'; border-bottom: 1px solid #333;
        }

        .win-bar-container { height: 4px; background: #111; display: flex; overflow: hidden; }
        #win-p1 { background: var(--neon-blue); height: 100%; transition: 1s; }
        #win-p2 { background: var(--neon-red); height: 100%; transition: 1s; }

        .main-board { 
            height: 70px; background: linear-gradient(90deg, #00122e 0%, #002b6b 100%);
            display: flex; align-items: center; position: relative; border-bottom: 3px solid var(--primary);
        }

        .team-tag { background: var(--primary); color: #000; font-weight: 900; font-size: 18px; padding: 0 15px; height: 100%; display: flex; align-items: center; clip-path: polygon(0 0, 85% 0, 100% 100%, 0% 100%); font-family: 'Orbitron'; min-width: 90px; }

        .live-score { font-size: 38px; font-weight: 900; padding: 0 10px; font-family: 'Orbitron'; display: flex; align-items: center; }
        .overs-small { font-size: 14px; opacity: 0.7; margin-left: 8px; font-family: 'Orbitron'; }

        .batsmen-section { flex-grow: 1; padding: 0 15px; border-left: 1px solid rgba(255,255,255,0.1); }
        .b-row { font-size: 14px; display: flex; justify-content: space-between; margin: 2px 0; font-family: 'Orbitron'; }
        .active-bat { color: var(--primary); }

        .opp-box { background: rgba(0,225,255,0.1); height: 100%; padding: 0 10px; display: flex; flex-direction: column; justify-content: center; text-align: center; min-width: 100px; border-left: 1px solid #00e1ff; }

        .bottom-strip { background: #000; padding: 6px 15px; display: flex; justify-content: space-between; align-items: center; font-size: 11px; border-top: 1px solid #222; font-family: 'Orbitron'; }

        .ball-tracker { display: flex; gap: 3px; }
        .b-dot { width: 18px; height: 18px; background: #222; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 9px; border: 1px solid #444; }
        .b-dot.active { background: var(--primary); color: #000; }

        /* Admin Controls - Exact layout from Image */
        .admin-section { padding: 15px; max-width: 950px; margin: auto; }
        .control-dashboard-title { color: var(--primary); font-family: 'Orbitron'; font-size: 20px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        
        .control-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #0a1221; padding: 20px; border-radius: 8px; border: 1px solid #1a2a44; }
        
        .btn-group-admin { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px; }
        
        /* Specific Button Colors from Image */
        .btn-blue { background: #1a73e8; color: white; }
        .btn-red { background: #ff0040; color: white; }
        .btn-yellow { background: var(--primary); color: #000; }
        .btn-green { background: #00c853; color: white; width: 100%; margin-bottom: 10px; }
        .btn-dark { background: #1c2533; color: white; width: 100%; border: 1px solid #333; }
        
        button { padding: 12px; font-weight: 700; border: none; border-radius: 4px; cursor: pointer; text-transform: uppercase; font-size: 12px; }
        input { width: 93%; padding: 10px; margin-bottom: 10px; background: #040d1a; border: 1px solid #1a2a44; color: white; border-radius: 4px; font-size: 13px; }
        
        #freehit-msg { position: fixed; top: 40%; width: 100%; background: #ff0040; color: white; font-size: 50px; font-weight: 900; text-align: center; padding: 20px 0; display: none; z-index: 3000; font-family: 'Orbitron'; box-shadow: 0 0 30px #ff0040; }
        #boundary-msg { position: fixed; top: 35%; width: 100%; background: var(--primary); color: #000; font-size: 70px; font-weight: 900; text-align: center; padding: 25px 0; display: none; z-index: 2000; font-family: 'Orbitron'; }
        
        .hidden { display: none !important; }
    </style>
</head>
<body onload="initApp()">

    <div id="boundary-msg">FOUR!</div>
    <div id="freehit-msg">FREE HIT!</div>

    <div class="master-container">
        <div class="top-status-bar">
            <span><span id="d-tour">TOURNAMENT</span> | <span id="d-proj" style="color:var(--primary)">CRR: 0.00</span></span>
            <span id="d-clock">00:00:00</span>
        </div>
        <div class="win-bar-container">
            <div id="win-p1" style="width: 50%;"></div>
            <div id="win-p2" style="width: 50%;"></div>
        </div>
        <div class="main-board">
            <div class="team-tag" id="d-team">TEAM A</div>
            <div class="live-score">
                <span id="d-runs">0</span>-<span id="d-wkt">0</span>
                <span class="overs-small">(<span id="d-ov">0.0</span>)</span>
            </div>
            <div class="batsmen-section">
                <div id="p1-row" class="b-row active-bat">
                    <span id="d-b1">BATSMAN 1</span> <span id="d-b1-r">0(0)</span>
                </div>
                <div id="p2-row" class="b-row">
                    <span id="d-b2">BATSMAN 2</span> <span id="d-b2-r">0(0)</span>
                </div>
            </div>
            <div class="opp-box">
                <span id="d-opp-name" style="font-size: 9px; color: var(--neon-blue);">OPPONENT</span>
                <span id="d-opp-score" style="font-size: 14px; font-weight: 900;">0-0 (0.0)</span>
                <span style="font-size: 8px; opacity: 0.8;">TARGET: <span id="d-target">0</span></span>
            </div>
        </div>
        <div class="bottom-strip">
            <span id="d-status">1ST INNINGS IN PROGRESS</span>
            <div style="display: flex; align-items: center; gap: 10px;">
                <span>BOWL: <span id="d-bowl" style="color:var(--primary)">WAITING</span> <span id="d-bowl-stat" style="font-size:9px; opacity:0.6;">(0-0)</span></span>
                <div class="ball-tracker" id="d-dots">
                    <div class="b-dot">1</div><div class="b-dot">2</div><div class="b-dot">3</div><div class="b-dot">4</div><div class="b-dot">5</div><div class="b-dot">6</div>
                </div>
            </div>
        </div>
    </div>

    <div class="admin-section" id="admin-main-view">
        <div id="login-area" class="login-card" style="text-align:center; padding: 50px;">
            <input type="password" id="pass-input" placeholder="ENTER PIN" style="font-size:20px; text-align:center;">
            <button class="btn-yellow" onclick="checkAuth()" style="width:100%;">UNLOCK</button>
        </div>

        <div id="admin-panel" class="hidden">
            <div class="control-dashboard-title">
                <span>CONTROL DASHBOARD</span>
                <button class="btn-red" onclick="lockPanel()" style="padding:5px 10px; font-size:10px;">ðŸ”’ LOCK & EXIT</button>
            </div>

            <div class="control-grid">
                <div class="card">
                    <p style="font-size:10px; color:#555; margin-top:0;">QUICK SCORING</p>
                    <div class="btn-group-admin">
                        <button class="btn-blue" onclick="addRun(1)">+1</button>
                        <button class="btn-blue" onclick="addRun(2)">+2</button>
                        <button class="btn-blue" onclick="addRun(3)">+3</button>
                        <button class="btn-red" onclick="addRun(-1)">-1</button>
                    </div>
                    <div class="btn-group-admin">
                        <button class="btn-yellow" onclick="addRun(4)">4</button>
                        <button class="btn-yellow" onclick="addRun(6)">6</button>
                        <button class="btn-red" onclick="outPlayer()" style="grid-column: span 2;">WICKET</button>
                    </div>
                    <div class="btn-group-admin">
                        <button class="btn-blue" onclick="extraRun('WD')">WIDE</button>
                        <button class="btn-blue" onclick="extraRun('NB')">NO BALL</button>
                        <button class="btn-blue" onclick="extraRun('LB')">BYES</button>
                        <button class="btn-blue" onclick="swapStrike()">SWAP</button>
                    </div>
                    <button class="btn-green" onclick="nextBall()">NEXT BALL (DOT)</button>
                    <button class="btn-dark" onclick="toggleAutoStrike()" id="auto-btn">ðŸ”„ AUTO STRIKE: ON</button>
                    <button class="btn-red" onclick="archiveMatch()" style="width:100%; margin-top:10px;">END & SAVE MATCH</button>
                </div>

                <div class="card">
                    <p style="font-size:10px; color:#555; margin-top:0;">MATCH SETUP</p>
                    <input type="text" id="i-tour" placeholder="Tournament Name" oninput="pushData()">
                    <input type="text" id="i-t1" placeholder="Batting Team Name" oninput="pushData()">
                    <input type="text" id="i-b1" placeholder="Striker Name" oninput="pushData()">
                    <input type="text" id="i-b2" placeholder="Non-Striker Name" oninput="pushData()">
                    <input type="text" id="i-bowl" placeholder="Current Bowler" oninput="pushData()">
                    <div style="display:flex; gap:10px;">
                        <input type="number" id="i-target" placeholder="Target" oninput="pushData()">
                        <button class="btn-yellow" onclick="toggleInn()" id="inn-btn" style="height:38px;">INN 1/2</button>
                    </div>
                    <input type="number" id="i-max-overs" placeholder="Match Overs (e.g. 20)" oninput="pushData()">
                </div>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "Https://myscoreboard-b140f-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref("broadcast_master_v3");
        const histDb = firebase.database().ref("match_history");

        let state = {
            r:0, w:0, o:0, b:0, t1:"TEAM A", tour:"TOURNAMENT", 
            oppN:"OPPONENT", oppS:"0-0 (0.0)", target:0, s:1, bowl:"WAITING",
            p1:{n:"BATSMAN 1", r:0, b:0}, p2:{n:"BATSMAN 2", r:0, b:0},
            inn:1, anim:"", maxO: 20, autoS: true, freeHit: false,
            bwlStat: {r:0, w:0}, ps: 0
        };

        function checkAuth() {
            if(document.getElementById('pass-input').value === "ChhotuLive8718") {
                localStorage.setItem("admin_login", "true");
                showAdmin();
            } else alert("WRONG PIN");
        }

        function showAdmin() {
            document.getElementById('admin-panel').classList.remove('hidden');
            document.getElementById('login-area').classList.add('hidden');
        }

        function lockPanel() { localStorage.removeItem("admin_login"); location.reload(); }

        function initApp() {
            if(localStorage.getItem("admin_login") === "true") showAdmin();
            setInterval(() => { document.getElementById('d-clock').innerText = new Date().toLocaleTimeString(); }, 1000);
            db.on('value', snap => { if(snap.val()){ state = snap.val(); updateUI(); if(localStorage.getItem("admin_login")==="true") syncInputs(); } });
        }

        function addRun(v) {
            if(v === -1 && state.r > 0) { state.r--; if(state.s===1)state.p1.r--; else state.p2.r--; }
            else if(v > 0) {
                state.r += v;
                state.ps += v;
                state.bwlStat.r += v;
                if(state.s === 1) state.p1.r += v; else state.p2.r += v;
                if(v === 4) state.anim = "FOUR"; else if(v === 6) state.anim = "SIX";
                if(state.autoS && (v === 1 || v === 3)) swapStrike();
            }
            if(state.freeHit) state.freeHit = false; 
            pushData();
            setTimeout(() => { state.anim = ""; pushData(); }, 3000);
        }

        function extraRun(type) {
            state.r += 1;
            state.bwlStat.r += 1;
            if(type === 'NB') { state.freeHit = true; state.anim = "NO BALL"; }
            if(type === 'WD') state.anim = "WIDE";
            pushData();
            setTimeout(() => { state.anim = ""; pushData(); }, 3000);
        }

        function nextBall() {
            if(state.s === 1) state.p1.b++; else state.p2.b++;
            state.b++;
            if(state.b >= 6) { state.o++; state.b = 0; if(state.autoS) swapStrike(); }
            state.freeHit = false;
            pushData();
        }

        function outPlayer() {
            if(state.freeHit) { alert("FREE HIT: CANNOT BE OUT!"); return; }
            let n = prompt("New Batsman Name:");
            if(n) {
                state.w++;
                state.bwlStat.w++;
                state.ps = 0;
                state.anim = "WICKET";
                if(state.s === 1) state.p1 = {n:n, r:0, b:0}; else state.p2 = {n:n, r:0, b:0};
                pushData();
                setTimeout(() => { state.anim = ""; pushData(); }, 3000);
            }
        }

        function swapStrike() { state.s = state.s === 1 ? 2 : 1; pushData(); }
        function toggleInn() { state.inn = state.inn === 1 ? 2 : 1; state.ps = 0; pushData(); }
        function toggleAutoStrike() { state.autoS = !state.autoS; pushData(); }

        function pushData() {
            if(localStorage.getItem("admin_login") === "true") {
                state.tour = document.getElementById('i-tour').value || state.tour;
                state.t1 = document.getElementById('i-t1').value || state.t1;
                state.p1.n = document.getElementById('i-b1').value || state.p1.n;
                state.p2.n = document.getElementById('i-b2').value || state.p2.n;
                state.bowl = document.getElementById('i-bowl').value || state.bowl;
                state.target = parseInt(document.getElementById('i-target').value) || 0;
                state.maxO = parseInt(document.getElementById('i-max-overs').value) || 20;
            }
            db.set(state);
        }

        function syncInputs() {
            document.getElementById('i-tour').value = state.tour;
            document.getElementById('i-t1').value = state.t1;
            document.getElementById('i-b1').value = state.p1.n;
            document.getElementById('i-b2').value = state.p2.n;
            document.getElementById('i-bowl').value = state.bowl;
            document.getElementById('i-target').value = state.target;
            document.getElementById('i-max-overs').value = state.maxO;
            document.getElementById('auto-btn').innerText = state.autoS ? "ðŸ”„ AUTO STRIKE: ON" : "ðŸ”„ AUTO STRIKE: OFF";
        }

        function updateUI() {
            document.getElementById('d-runs').innerText = state.r;
            document.getElementById('d-wkt').innerText = state.w;
            document.getElementById('d-ov').innerText = state.o + "." + state.b;
            document.getElementById('d-team').innerText = state.t1.toUpperCase();
            document.getElementById('d-tour').innerText = state.tour.toUpperCase();
            document.getElementById('d-b1').innerText = state.p1.n;
            document.getElementById('d-b1-r').innerText = `${state.p1.r}(${state.p1.b})`;
            document.getElementById('d-b2').innerText = state.p2.n;
            document.getElementById('d-b2-r').innerText = `${state.p2.r}(${state.p2.b})`;
            document.getElementById('d-bowl').innerText = state.bowl.toUpperCase();
            document.getElementById('d-bowl-stat').innerText = `(${state.bwlStat.w}-${state.bwlStat.r})`;
            document.getElementById('d-target').innerText = state.target;

            let played = (state.o * 6) + state.b;
            if(played > 0) {
                let crr = ((state.r / played) * 6).toFixed(2);
                document.getElementById('d-proj').innerText = state.inn === 1 ? "CRR: "+crr : "RRR: "+(( (state.target-state.r) / ((state.maxO*6)-played) )*6).toFixed(2);
            }
            
            document.getElementById('d-status').innerText = state.inn === 1 ? `PARTNERSHIP: ${state.ps}` : `NEED ${state.target-state.r} IN ${(state.maxO*6)-played} BALLS`;
            
            // Win Bar
            let win = state.target > 0 ? (state.r/state.target)*100 : 50;
            document.getElementById('win-p1').style.width = win + "%";
            document.getElementById('win-p2').style.width = (100-win) + "%";

            // Animations
            document.getElementById('boundary-msg').style.display = state.anim ? 'block' : 'none';
            if(state.anim) document.getElementById('boundary-msg').innerText = state.anim + "!";
            document.getElementById('freehit-msg').style.display = state.freeHit ? 'block' : 'none';

            document.getElementById('p1-row').className = state.s === 1 ? "b-row active-bat" : "b-row";
            document.getElementById('p2-row').className = state.s === 2 ? "b-row active-bat" : "b-row";

            const dots = document.querySelectorAll('.b-dot');
            dots.forEach((d, i) => d.className = i < state.b ? "b-dot active" : "b-dot");
        }

        function archiveMatch() {
            if(confirm("SAVE MATCH?")) {
                histDb.push(state).then(() => {
                    db.set({r:0, w:0, o:0, b:0, t1:"TEAM A", tour:"TOURNAMENT", oppN:"OPPONENT", oppS:"0-0 (0.0)", target:0, s:1, bowl:"WAITING", p1:{n:"BATSMAN 1", r:0, b:0}, p2:{n:"BATSMAN 2", r:0, b:0}, inn:1, anim:"", maxO: 20, autoS: true, freeHit: false, bwlStat: {r:0, w:0}, ps: 0});
                    location.reload();
                });
            }
        }
    </script>
</body>
</html>
