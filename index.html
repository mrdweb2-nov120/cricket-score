<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHHOTU BROADCAST PRO | 2026 ELITE EDITION</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@300;400;700;900&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">

    <style>
        /* BROADCAST DESIGN SYSTEM - PRESET 2026 
           THEME: DEEP RED | CHARCOAL | GOLD ACCENTS
        */
        :root {
            --primary-red: #8b0000;
            --dark-red: #4a0000;
            --accent-gold: #fec309;
            --bg-black: #050505;
            --panel-gray: #1a1a1a;
            --text-white: #ffffff;
            --sharp-cut: polygon(10% 0%, 100% 0%, 90% 100%, 0% 100%);
            --left-cut: polygon(0 0, 95% 0, 100% 100%, 0 100%);
            --right-cut: polygon(5% 0, 100% 0, 100% 100%, 0 100%);
            --center-cut: polygon(5% 0, 95% 0, 100% 100%, 0 100%);
            --transition-smooth: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* RESET & BASE */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background: transparent; /* For OBS Overlay */
            font-family: 'Outfit', sans-serif;
            color: var(--text-white);
            overflow-x: hidden;
            height: 100vh;
        }

        /* LAYER 1: THE MAIN BROADCAST STRIP (OBS VIEW)
           -------------------------------------------
        */
        .overlay-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            max-width: 1400px;
            z-index: 9999;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.8));
        }

        /* MAIN SCOREBOARD FLEXBOX */
        .scoreboard-flex {
            display: flex;
            align-items: stretch;
            height: 80px;
            background: linear-gradient(to bottom, #111, #000);
            border-bottom: 3px solid var(--primary-red);
            position: relative;
            overflow: visible;
        }

        /* LEFT PANEL: BATSMEN */
        .panel-batsman {
            flex: 1.5;
            background: var(--panel-gray);
            clip-path: var(--left-cut);
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 40px 0 20px;
            position: relative;
            border-left: 5px solid var(--primary-red);
        }

        .batsman-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2px 0;
            opacity: 0.6;
            transition: var(--transition-smooth);
        }

        .batsman-row.active {
            opacity: 1;
            transform: scale(1.05);
        }

        .batsman-row.active .b-name { color: var(--accent-gold); text-shadow: 0 0 10px rgba(254, 195, 9, 0.4); }

        .b-name { font-family: 'Bebas Neue'; font-size: 22px; letter-spacing: 1px; }
        .b-score { font-family: 'Roboto Mono'; font-weight: 700; font-size: 18px; }

        .strike-indicator {
            width: 8px; height: 8px; background: var(--accent-gold);
            border-radius: 50%; display: none; margin-right: 8px;
            box-shadow: 0 0 10px var(--accent-gold);
        }
        .active .strike-indicator { display: inline-block; animation: pulse 1s infinite; }

        /* CENTER PANEL: CORE SCORE */
        .panel-main-score {
            flex: 1.2;
            background: linear-gradient(135deg, var(--dark-red) 0%, var(--primary-red) 100%);
            clip-path: var(--center-cut);
            margin: 0 -15px;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-top: 2px solid rgba(255,255,255,0.2);
        }

        .team-name { font-size: 14px; font-weight: 900; letter-spacing: 3px; color: rgba(255,255,255,0.7); }
        .score-wrap { display: flex; align-items: baseline; gap: 5px; margin-top: -5px; }
        .big-score { font-family: 'Bebas Neue'; font-size: 52px; color: white; }
        .big-wickets { font-family: 'Bebas Neue'; font-size: 38px; color: var(--accent-gold); }
        .overs-tag { font-family: 'Roboto Mono'; font-size: 16px; background: rgba(0,0,0,0.3); padding: 2px 10px; border-radius: 4px; }

        /* RIGHT PANEL: BOWLER */
        .panel-bowler {
            flex: 1.5;
            background: var(--panel-gray);
            clip-path: var(--right-cut);
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 20px 0 40px;
            text-align: right;
            border-right: 5px solid var(--primary-red);
        }

        .bowler-label { font-size: 10px; color: var(--accent-gold); letter-spacing: 2px; font-weight: 700; }
        .bowler-name { font-family: 'Bebas Neue'; font-size: 24px; }
        .bowler-stats { font-family: 'Roboto Mono'; font-size: 16px; color: #aaa; }

        /* OVER DOTS */
        .over-balls { display: flex; gap: 5px; justify-content: flex-end; margin-top: 5px; }
        .ball-dot { width: 10px; height: 10px; border-radius: 2px; background: #333; transform: skewX(-15deg); }
        .ball-dot.filled { background: var(--accent-gold); box-shadow: 0 0 8px var(--accent-gold); }

        /* TICKER STRIP (BOTTOM MOST) 
        */
        .ticker-strip {
            height: 25px;
            background: rgba(0, 0, 0, 0.9);
            margin-top: -2px;
            display: flex;
            align-items: center;
            padding: 0 50px;
            font-size: 12px;
            font-weight: 700;
            color: #ccc;
            border-top: 1px solid #222;
        }

        .ticker-item { margin-right: 30px; display: flex; align-items: center; }
        .ticker-label { color: var(--accent-gold); margin-right: 5px; }

        /* LAYER 2: ADMIN & ANALYTICS (NON-OBS VIEW)
           -------------------------------------------
        */
        .admin-section {
            background: #0d0d0d;
            padding: 40px;
            margin-bottom: 200px; /* Space for overlay */
        }

        .console-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .glass-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.05);
            padding: 25px;
            border-radius: 15px;
        }

        button {
            cursor: pointer;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-weight: 900;
            font-family: 'Bebas Neue';
            font-size: 18px;
            transition: 0.2s;
            text-transform: uppercase;
        }

        .btn-main { background: var(--primary-red); color: white; width: 100%; margin-bottom: 10px; font-size: 24px; }
        .btn-sub { background: #333; color: white; flex: 1; }
        .btn-gold { background: var(--accent-gold); color: black; }
        
        .flex-row { display: flex; gap: 10px; margin-bottom: 10px; }

        input {
            width: 100%; background: #1a1a1a; border: 1px solid #333;
            color: white; padding: 12px; border-radius: 8px; margin-bottom: 15px;
        }

        /* GLOW ANIMATION FOR BOXES */
        @keyframes border-glow {
            0% { border-color: var(--primary-red); }
            50% { border-color: var(--accent-gold); }
            100% { border-color: var(--primary-red); }
        }

        .scoreboard-flex { animation: border-glow 4s infinite; }

    </style>
</head>
<body onload="initializeBroadcast()">

    <div class="overlay-container animate__animated animate__slideInUp">
        <div class="scoreboard-flex">
            
            <div class="panel-batsman">
                <div class="batsman-row" id="row-p1">
                    <span class="b-name"><span class="strike-indicator"></span><span id="ui-p1-name">BATSMAN 1</span></span>
                    <span class="b-score" id="ui-p1-score">0 (0)</span>
                </div>
                <div class="batsman-row" id="row-p2">
                    <span class="b-name"><span class="strike-indicator"></span><span id="ui-p2-name">BATSMAN 2</span></span>
                    <span class="b-score" id="ui-p2-score">0 (0)</span>
                </div>
            </div>

            <div class="panel-main-score">
                <div class="team-name" id="ui-team-name">TEAM INDIA</div>
                <div class="score-wrap">
                    <span class="big-score" id="ui-runs">0</span>
                    <span class="big-wickets">/ <span id="ui-wkts">0</span></span>
                </div>
                <div class="overs-tag">OVS: <span id="ui-overs">0.0</span></div>
            </div>

            <div class="panel-bowler">
                <div class="bowler-label">CURRENT BOWLER</div>
                <div class="bowler-name" id="ui-bowler">BOWLER NAME</div>
                <div class="over-balls" id="ui-ball-dots">
                    </div>
            </div>
        </div>

        <div class="ticker-strip">
            <div class="ticker-item"><span class="ticker-label">TARGET:</span> <span id="ui-target-val">000</span></div>
            <div class="ticker-item"><span class="ticker-label">RRR:</span> <span id="ui-rrr">0.00</span></div>
            <div class="ticker-item"><span class="ticker-label">CRR:</span> <span id="stat-rr">0.00</span></div>
            <div class="ticker-item"><span class="ticker-label">PARTNERSHIP:</span> <span id="stat-pship">0(0)</span></div>
            <div style="margin-left: auto; color: var(--accent-gold); font-family: 'Roboto Mono';" id="ui-clock">00:00:00</div>
        </div>
    </div>

    <div class="admin-section">
        <div id="auth-panel" class="glass-card" style="max-width: 500px; margin: 0 auto; text-align: center;">
            <h1 style="font-family: 'Bebas Neue'; color: var(--accent-gold); font-size: 40px;">BROADCAST ENGINE AUTH</h1>
            <input type="password" id="master-key" placeholder="ENTER ACCESS KEY" style="text-align: center; letter-spacing: 5px;">
            <button class="btn-main" onclick="validateAccess()">UNLOCK CONSOLE</button>
        </div>

        <div id="master-console" style="display: none;">
            <h2 style="font-family: 'Bebas Neue'; font-size: 30px; margin-bottom: 20px; color: var(--primary-red);">// MASTER CONTROL CONSOLE</h2>
            
            <div class="console-grid">
                <div class="glass-card">
                    <h3 style="margin-bottom: 15px; color: var(--accent-gold);">SCORING UNIT</h3>
                    <button class="btn-main" onclick="processBall(0)" style="background: #222; border: 1px solid #444;">DOT BALL</button>
                    <div class="flex-row">
                        <button class="btn-sub" onclick="processBall(1)">1 RUN</button>
                        <button class="btn-sub" onclick="processBall(2)">2 RUNS</button>
                        <button class="btn-sub" onclick="processBall(3)">3 RUNS</button>
                    </div>
                    <div class="flex-row">
                        <button class="btn-main" onclick="processBall(4)" style="background: #1e3a8a;">FOUR (4)</button>
                        <button class="btn-main" onclick="processBall(6)" style="background: #581c87;">SIX (6)</button>
                    </div>
                    <div class="flex-row">
                        <button class="btn-sub" style="background: #b91c1c;" onclick="processWicket()">WICKET</button>
                        <button class="btn-sub" onclick="undoStep()">UNDO LAST</button>
                    </div>
                    <div class="flex-row">
                        <button class="btn-sub" onclick="processExtra('WD')">WD</button>
                        <button class="btn-sub" onclick="processExtra('NB')">NB</button>
                        <button class="btn-sub" onclick="toggleStrike()" style="background: var(--accent-gold); color: black;">SWAP STRIKE</button>
                    </div>
                </div>

                <div class="glass-card">
                    <h3 style="margin-bottom: 15px; color: var(--accent-gold);">MATCH CONFIG</h3>
                    <label>BATTING TEAM</label>
                    <input type="text" id="in-team" oninput="syncToCloud()">
                    <label>TARGET RUNS</label>
                    <input type="number" id="in-target" oninput="syncToCloud()">
                    <label>CURRENT BOWLER</label>
                    <input type="text" id="in-bowler" oninput="syncToCloud()">
                </div>

                <div class="glass-card">
                    <h3 style="margin-bottom: 15px; color: var(--accent-gold);">PLAYER MANAGEMENT</h3>
                    <label>STRIKER NAME</label>
                    <input type="text" id="in-p1-n" oninput="syncToCloud()">
                    <label>NON-STRIKER NAME</label>
                    <input type="text" id="in-p2-n" oninput="syncToCloud()">
                    <button class="btn-sub" style="width: 100%;" onclick="resetMatchEngine()">HARD RESET ENGINE</button>
                </div>
            </div>

            <div class="glass-card" style="margin-top: 30px;">
                <h3 style="color: var(--accent-gold);">WORM GRAPH</h3>
                <div style="height: 200px;"><canvas id="wormChart"></canvas></div>
            </div>
        </div>
    </div>

    <script>
        /* THE ENGINE - V2026 BROADCAST CORE
        */

        const firebaseConfig = { databaseURL: "https://myscoreboard-b140f-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const engineDB = firebase.database().ref("broadcast_v2026_elite");

        let matchState = {
            score: { runs: 0, wkts: 0, overs: 0, balls: 0, target: 0 },
            teams: { batting: "INDIA" },
            players: {
                p1: { name: "PLAYER 1", runs: 0, balls: 0 },
                p2: { name: "PLAYER 2", runs: 0, balls: 0 },
                bowler: "BOWLER",
                strike: 1
            },
            analytics: { graphData: [0], partnership: { r: 0, b: 0 } },
            history: []
        };

        let graphWidget;

        function initializeBroadcast() {
            startClock();
            setupChart();
            if(localStorage.getItem("admin_auth_pro") === "CLEARED") showConsole();

            engineDB.on('value', (snapshot) => {
                const data = snapshot.val();
                if(data) {
                    matchState = data;
                    updateUI();
                }
            });
        }

        function validateAccess() {
            if(document.getElementById('master-key').value === "Chhotu8718") {
                localStorage.setItem("admin_auth_pro", "CLEARED");
                showConsole();
            } else {
                alert("ACCESS DENIED");
            }
        }

        function showConsole() {
            document.getElementById('auth-panel').style.display = "none";
            document.getElementById('master-console').style.display = "block";
        }

        function processBall(run) {
            recordHistory();
            matchState.score.runs += run;
            matchState.analytics.partnership.r += run;
            
            const current = matchState.players.strike === 1 ? matchState.players.p1 : matchState.players.p2;
            current.runs += run;
            current.balls += 1;

            matchState.score.balls += 1;
            matchState.analytics.partnership.b += 1;

            if(matchState.score.balls >= 6) {
                matchState.score.overs += 1;
                matchState.score.balls = 0;
                matchState.analytics.graphData.push(matchState.score.runs);
                toggleStrike();
            }
            if(run === 1 || run === 3) toggleStrike();
            syncToCloud();
        }

        function toggleStrike() {
            matchState.players.strike = matchState.players.strike === 1 ? 2 : 1;
            syncToCloud();
        }

        function processWicket() {
            let name = prompt("NEW BATSMAN NAME:");
            if(name) {
                recordHistory();
                matchState.score.wkts += 1;
                matchState.analytics.partnership = { r: 0, b: 0 };
                if(matchState.players.strike === 1) {
                    matchState.players.p1 = { name: name.toUpperCase(), runs: 0, balls: 0 };
                } else {
                    matchState.players.p2 = { name: name.toUpperCase(), runs: 0, balls: 0 };
                }
                syncToCloud();
            }
        }

        function processExtra(type) {
            recordHistory();
            matchState.score.runs += 1;
            if(type === 'LB') {
                matchState.score.balls += 1;
                if(matchState.score.balls >= 6) {
                    matchState.score.overs += 1;
                    matchState.score.balls = 0;
                }
            }
            syncToCloud();
        }

        function recordHistory() {
            if(!matchState.history) matchState.history = [];
            matchState.history.push(JSON.parse(JSON.stringify(matchState)));
            if(matchState.history.length > 10) matchState.history.shift();
        }

        function undoStep() {
            if(matchState.history && matchState.history.length > 0) {
                matchState = matchState.history.pop();
                syncToCloud();
            }
        }

        function syncToCloud() {
            matchState.teams.batting = document.getElementById('in-team').value;
            matchState.score.target = parseInt(document.getElementById('in-target').value) || 0;
            matchState.players.bowler = document.getElementById('in-bowler').value;
            matchState.players.p1.name = document.getElementById('in-p1-n').value;
            matchState.players.p2.name = document.getElementById('in-p2-n').value;
            engineDB.set(matchState);
        }

        function updateUI() {
            // Broadcast Bar
            document.getElementById('ui-runs').innerText = matchState.score.runs;
            document.getElementById('ui-wkts').innerText = matchState.score.wkts;
            document.getElementById('ui-overs').innerText = matchState.score.overs + "." + matchState.score.balls;
            document.getElementById('ui-team-name').innerText = matchState.teams.batting;
            document.getElementById('ui-bowler').innerText = matchState.players.bowler;
            document.getElementById('ui-target-val').innerText = matchState.score.target;

            // Players
            document.getElementById('ui-p1-name').innerText = matchState.players.p1.name;
            document.getElementById('ui-p1-score').innerText = matchState.players.p1.runs + " (" + matchState.players.p1.balls + ")";
            document.getElementById('ui-p2-name').innerText = matchState.players.p2.name;
            document.getElementById('ui-p2-score').innerText = matchState.players.p2.runs + " (" + matchState.players.p2.balls + ")";

            document.getElementById('row-p1').className = matchState.players.strike === 1 ? "batsman-row active" : "batsman-row";
            document.getElementById('row-p2').className = matchState.players.strike === 2 ? "batsman-row active" : "batsman-row";

            // Calculation Logic
            let totalBalls = (matchState.score.overs * 6) + matchState.score.balls;
            let crr = totalBalls > 0 ? (matchState.score.runs / totalBalls) * 6 : 0;
            document.getElementById('stat-rr').innerText = crr.toFixed(2);
            document.getElementById('stat-pship').innerText = matchState.analytics.partnership.r + "(" + matchState.analytics.partnership.b + ")";

            if(matchState.score.target > 0) {
                let remR = matchState.score.target - matchState.score.runs;
                let remB = 120 - totalBalls;
                let rrr = remB > 0 ? (remR / remB) * 6 : 0;
                document.getElementById('ui-rrr').innerText = rrr.toFixed(2);
            }

            // Ball Dots
            let dotsHtml = "";
            for(let i=1; i<=6; i++) {
                dotsHtml += `<div class="ball-dot ${i <= matchState.score.balls ? 'filled' : ''}"></div>`;
            }
            document.getElementById('ui-ball-dots').innerHTML = dotsHtml;

            // Sync Inputs
            document.getElementById('in-team').value = matchState.teams.batting;
            document.getElementById('in-target').value = matchState.score.target;
            document.getElementById('in-bowler').value = matchState.players.bowler;
            document.getElementById('in-p1-n').value = matchState.players.p1.name;
            document.getElementById('in-p2-n').value = matchState.players.p2.name;

            // Chart Update
            if(graphWidget) {
                graphWidget.data.labels = matchState.analytics.graphData.map((_, i) => i);
                graphWidget.data.datasets[0].data = matchState.analytics.graphData;
                graphWidget.update();
            }
        }

        function setupChart() {
            const ctx = document.getElementById('wormChart').getContext('2d');
            graphWidget = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [0],
                    datasets: [{
                        data: [0],
                        borderColor: '#fec309',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        backgroundColor: 'rgba(254, 195, 9, 0.1)'
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });
        }

        function startClock() {
            setInterval(() => {
                document.getElementById('ui-clock').innerText = new Date().toLocaleTimeString();
            }, 1000);
        }

        function resetMatchEngine() {
            if(confirm("RESET ALL DATA?")) {
                matchState = {
                    score: { runs: 0, wkts: 0, overs: 0, balls: 0, target: 0 },
                    teams: { batting: "TEAM A" },
                    players: { p1: { name: "PLAYER 1", runs: 0, balls: 0 }, p2: { name: "PLAYER 2", runs: 0, balls: 0 }, bowler: "BOWLER", strike: 1 },
                    analytics: { graphData: [0], partnership: { r: 0, b: 0 } },
                    history: []
                };
                syncToCloud();
            }
        }
    </script>
</body>
</html>
